(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{sVx9:function(t,a,e){"use strict";e.r(a);var r,i=e("wd/R"),s={name:"RekapitulasiExtract",props:{proyek:Object,roundKerja:[String,Number],roundLembur:[String,Number],dataUri:String,query:Array},data:function(){return{display_picker:!1,filterDates:i().format("YYYY-MM-DD"),search:"",page:1,items:[],loading:!1,headers:[{text:"Operator",value:"nama_lengkap"},{text:"Unit",value:"no_lambung"},{text:"Tipe",value:"tipe_unit"},{text:"No Polisi",value:"no_polisi"},{text:"No Rekening",value:"no_rekening"},{text:"Nama Pemilik Rekening",value:"nama_pemilik_rekening"},{text:"Extract",value:"extract",align:"center"},{text:"Total",value:"total",align:"end"}],dialog:!1,fieldState:!1,form_alert_state:!1,form_alert_color:"error",form_alert_text:""}},computed:{dateFieldText:function(){return this.reformatDateTime(this.filterDates,"YYYY-MM-DD","DD MMMM YYYY")},queryParams:function(){var t=["search="+this.search,"page="+this.page,"paginate=1000","start_date="+this.filterDates,"end_date="+this.filterDates];return _.join(_.merge(t,this.query),"&")}},mounted:function(){this.getData()},methods:{hideDatePicker:function(){this.display_picker=!1,this.getData()},showDuration:function(t,a){console.log(a);var e=0;if(t>0){console.log("durasi lebih dari 0"),e=Math.floor(t/60),console.log(e);var r=t%60;"kerja"==a&&r>this.roundKerja&&(e+=1),"lembur"==a&&r>this.roundLembur&&(e+=1)}return e+" jam "},showGrandTotal:function(){return _.sumBy(this.items,"total")},itemSlotName:function(t){return"item."+t},getData:function(){var t=this;this.loading=!0,r&&r.cancel(),r=axios.CancelToken.source(),axios.get(this.dataUri+"?"+this.queryParams,{cancelToken:r.token}).then((function(a){a.data.success&&t.setData(a.data.data),t.loading=!1})).catch((function(a){t.loading=!1}))},setData:function(t){this.items=t.table.data},postSelected:function(){var t=this;this.fieldState=!0;var a=new FormData;_.forEach(_.flatten(_.merge([],_.map(this.items,"source_id"))),(function(t){a.append("id[]",t)})),axios.post(this.ziggy("jamkerja.rekapitulasi.detail.extract",[this.proyek.slug]).url(),a).then((function(a){a.data.success?(window.open(a.data.data,"_blank"),t.getData()):(t.form_alert_state=!0,t.form_alert_color="error",t.form_alert_text=a.data.message),t.dialog=!1,t.fieldState=!1})).catch((function(a){t.fieldState=!1,t.form_alert_state=!0,t.form_alert_color="error",t.form_alert_text=a.response.data.message}))}}},n=e("KHd+"),o=Object(n.a)(s,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-card",{attrs:{flat:""}},[e("v-row",{staticClass:"ml-0"},[e("v-col",{attrs:{md:"4",sm:"6"}},[e("v-menu",{ref:"display_picker",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(a){var r=a.on,i=a.attrs;return[e("v-text-field",t._g(t._b({attrs:{"prepend-icon":"mdi-calendar",readonly:"",disabled:t.fieldState||t.loading},model:{value:t.dateFieldText,callback:function(a){t.dateFieldText=a},expression:"dateFieldText"}},"v-text-field",i,!1),r))]}}]),model:{value:t.display_picker,callback:function(a){t.display_picker=a},expression:"display_picker"}},[t._v(" "),e("v-date-picker",{attrs:{"no-title":""},on:{input:function(a){return t.hideDatePicker()}},model:{value:t.filterDates,callback:function(a){t.filterDates=a},expression:"filterDates"}})],1)],1),t._v(" "),e("v-col",{staticClass:"text-right",attrs:{md:"8",sm:"6"}},[e("v-btn",{staticClass:"mt-2",attrs:{elevation:"5",color:"primary",loading:t.loading,disabled:t.fieldState},on:{click:function(a){return t.getData()}}},[e("v-icon",[t._v("mdi-sync")])],1),t._v(" "),e("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(a){var r=a.on,i=a.attrs;return[e("v-btn",t._g(t._b({staticClass:"mt-1 ml-4 px-6 py-5 white--text",attrs:{elevation:"5",color:"success"}},"v-btn",i,!1),r),[t._t("extraButton",[t._v("\n              EXTRACT DATA\n            ")])],2)]}}],null,!0),model:{value:t.dialog,callback:function(a){t.dialog=a},expression:"dialog"}},[t._v(" "),e("v-card",[t._t("extraPromptContainer",[e("v-card-title",{staticClass:"text-center"},[e("v-icon",{staticClass:"text-h1 mx-auto",attrs:{color:"yellow darken-1","x-large":""}},[t._v("mdi-alert")])],1),t._v(" "),e("v-card-text",{staticClass:"font-weight-bold"},[t._v("Apakah Anda yakin ingin extract data upah mitra?")])]),t._v(" "),e("v-card-actions",[e("v-spacer"),t._v(" "),e("v-btn",{staticClass:"mt-1 ml-4 px-6 py-5",attrs:{color:"red darken-4",text:"",disabled:t.fieldState||t.loading},on:{click:function(a){t.dialog=!1}}},[t._v("\n              Batal\n            ")]),t._v(" "),e("v-btn",{staticClass:"mt-1 ml-4 px-6 py-5 white--text",attrs:{color:"success",loading:t.fieldState||t.loading,disabled:t.fieldState||t.loading},on:{click:function(a){return t.postSelected()}}},[t._v("\n              Submit\n            ")])],1)],2)],1)],1)],1),t._v(" "),e("v-data-table",{attrs:{headers:t.headers,items:t.items,"hide-default-footer":"","fixed-header":"","disable-sort":"","no-data-text":"Tidak data untuk ditampilkan.",loading:t.loading,"loading-text":"Mohon menunggu ..."},scopedSlots:t._u([{key:"item.total",fn:function(a){var r=a.item;return[e("v-tooltip",{attrs:{top:"",color:"transparent"},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on,s=a.attrs;return[e("span",t._g(t._b({staticClass:"red--text text--darken-4 font-weight-medium"},"span",s,!1),i),[t._v(t._s(t.number_format(r.total)))])]}}],null,!0)},[t._v(" "),e("v-card",{attrs:{dark:"",flat:"",outlined:""}},[e("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[e("tbody",[e("tr",[e("th",{attrs:{scope:"row"}},[t._v("Tipe Kerja:")]),t._v(" "),e("td",{attrs:{align:"right"}})]),t._v(" "),e("tr",[e("th",{attrs:{scope:"row"}},[t._v("Normal:")]),t._v(" "),e("td",{attrs:{align:"right"}},[t._v(t._s(r[t.filterDates]?t.showDuration(r[t.filterDates].total_durasi_kerja,"kerja"):"-"))])]),t._v(" "),e("tr",[e("th",{attrs:{scope:"row"}},[t._v("Standby:")]),t._v(" "),e("td",{attrs:{align:"right"}},[t._v(t._s(r[t.filterDates]?t.showDuration(r[t.filterDates].total_durasi_standby,"standby"):"-"))])]),t._v(" "),e("tr",[e("th",{attrs:{scope:"row"}},[t._v("Lembur 1:")]),t._v(" "),e("td",{attrs:{align:"right"}},[t._v(t._s(t.showDuration(r[t.filterDates].total_durasi_split_lembur1,"lembur")))])]),t._v(" "),e("tr",[e("th",{attrs:{scope:"row"}},[t._v("Lembur 2:")]),t._v(" "),e("td",{attrs:{align:"right"}},[t._v(t._s(t.showDuration(r[t.filterDates].total_durasi_split_lembur2,"lembur")))])]),t._v(" "),e("tr",[e("th",{attrs:{scope:"row"}},[t._v("Upah:")]),t._v(" "),e("td",{attrs:{align:"right"}},[e("p",{staticClass:"mb-0"},[t._v(t._s(r[t.filterDates].ada_selisih>0?"Selisih Upah "+r[t.filterDates].start_date:"Upah Harian"))])])]),t._v(" "),e("tr",[e("th",{attrs:{scope:"row"}},[t._v("Upah Kerja:")]),t._v(" "),e("td",{attrs:{align:"right"}},[t._v(t._s(t.number_format(parseFloat(r[t.filterDates].total_upah_harian)-parseFloat(r[t.filterDates].total_upah_bbm))))])]),t._v(" "),e("tr",[e("th",{attrs:{scope:"row"}},[t._v("Upah BBM:")]),t._v(" "),e("td",{attrs:{align:"right"}},[t._v(t._s(t.number_format(r[t.filterDates].total_upah_bbm)))])])])]},proxy:!0}],null,!0)})],1)],1)]}},t.items.length>0?{key:"body.append",fn:function(a){a.headers;return[e("tr",[e("td",{attrs:{colspan:"7",align:"right"}},[e("span",{staticClass:"font-weight-medium"},[t._v("\n            Total\n          ")])]),t._v(" "),e("td",{attrs:{align:"right"}},[e("span",{staticClass:"red--text text--darken-4 font-weight-medium"},[t._v("\n            "+t._s(t.number_format(t.showGrandTotal()))+"\n          ")])])])]}}:null],null,!0)}),t._v(" "),e("v-snackbar",{attrs:{timeout:3e3,color:t.form_alert_color},model:{value:t.form_alert_state,callback:function(a){t.form_alert_state=a},expression:"form_alert_state"}},[t._v("\n    "+t._s(t.form_alert_text)+"\n  ")])],1)}),[],!1,null,null,null);a.default=o.exports}}]);