(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{t2gS:function(t,e,a){"use strict";a.r(e);var n,o=a("wd/R"),r={name:"UpahTable",props:{dataUri:String,query:Array,roundKerja:[String,Number],roundLembur:[String,Number],jumlah:Number,showSelect:{type:Boolean,default:function(){return!1}},disableExtraButton:{type:Boolean,default:function(){return!1}},extraButtonUri:String,extraButtonColor:{type:String,default:function(){return"red darken-4"}},extraButtonFunction:Function,disableDownloadButton:{type:Boolean,default:function(){return!1}},downloadButtonUri:String,downloadButtonColor:{type:String,default:function(){return"red darken-4"}}},data:function(){return{selected:[],display_picker:!1,filterDates:[o().format("YYYY-MM-DD"),o().format("YYYY-MM-DD")],search:"",page:1,items:[],loading:!1,headers:[{text:"Operator",value:"nama_lengkap"},{text:"Unit",value:"no_lambung"},{text:"Tipe",value:"tipe_unit"},{text:"No Polisi",value:"no_polisi"},{text:"No Rekening",value:"no_rekening"},{text:"Nama Pemilik Rekening",value:"nama_pemilik_rekening"}],showDates:[],dialog:!1,downloadDialog:!1,fieldState:!1,form_alert_state:!1,form_alert_color:"error",form_alert_text:"",hideTableDate:!1}},computed:{dateRangeText:function(){var t=this,e=[];return _.forEach(this.filterDates,(function(a){e.push(t.reformatDateTime(a,"YYYY-MM-DD","DD MMMM YYYY"))})),_.join(e," - ")},queryParams:function(){var t=["search="+this.search,"page="+this.page,"paginate=1000","start_date="+this.filterDates[0],"end_date="+this.filterDates[1]];return _.join(_.merge(t,this.query),"&")},tableHeaders:function(){var t=[{text:"Operator",value:"nama_lengkap"},{text:"Unit",value:"no_lambung"},{text:"Tipe",value:"tipe_unit"},{text:"No Polisi",value:"no_polisi"},{text:"No Rekening",value:"no_rekening"},{text:"Nama Pemilik Rekening",value:"nama_pemilik_rekening"}];return this.hideTableDate||_.forEach(this.showDates,(function(e){t.push({text:e,value:e,align:"end"})})),t.push({text:"Total",value:"total",align:"end"}),t}},mounted:function(){this.getData()},methods:{sortDates:function(){this.filterDates.length>1?(this.display_picker=!1,this.filterDates.sort(),this.getData()):this.display_picker=!0},showDuration:function(t,e){var a=0;if(t>0){a=Math.floor(t/60);var n=t%60;"kerja"==e&&n>this.roundKerja&&(a+=1),"lembur"==e&&n>this.roundLembur&&(a+=1)}return a+" jam "},showTotal:function(t){return _.sumBy(this.items,(function(e){return e[t].total_upah_harian}))},showGrandTotal:function(){return _.sumBy(this.items,"total")},detailUri:function(t){return this.ziggy(this.route,[t.slug]).url()},headerSlotName:function(t){return"header."+t},itemSlotName:function(t){return"item."+t},getData:function(){var t=this;this.loading=!0,n&&n.cancel(),n=axios.CancelToken.source(),axios.get(this.dataUri+"?"+this.queryParams,{cancelToken:n.token}).then((function(e){e.data.success&&t.setData(e.data.data),t.loading=!1})).catch((function(e){t.loading=!1}))},setData:function(t){this.items=t.table.data,this.showDates=t.date,this.selected=[],this.$emit("update:jumlah",this.items.length)},postSelected:function(){var t=this;this.fieldState=!0;var e=new FormData;_.forEach(_.flatten(_.merge([],_.map(this.selected,"source_id"))),(function(t){e.append("id[]",t)})),axios.post(this.extraButtonUri,e).then((function(e){e.data.success?_.isUndefined(t.extraButtonFunction)||t.extraButtonFunction(e.data):(t.form_alert_state=!0,t.form_alert_color="error",t.form_alert_text=e.data.message),t.dialog=!1,t.fieldState=!1,t.getData()})).catch((function(e){t.fieldState=!1,t.form_alert_state=!0,t.form_alert_color="error",t.form_alert_text=e.response.data.message}))},downloadSelected:function(){var t=this;this.fieldState=!0;var e=new FormData;e.append("start_date",this.filterDates[0]),e.append("end_date",this.filterDates[1]),axios.post(this.downloadButtonUri,e).then((function(e){e.data.success?window.open(e.data.data,"_blank"):(t.form_alert_state=!0,t.form_alert_color="error",t.form_alert_text=e.data.message),t.downloadDialog=!1,t.fieldState=!1,t.getData()})).catch((function(e){t.fieldState=!1,t.form_alert_state=!0,t.form_alert_color="error",t.form_alert_text=e.response.data.message}))}}},i=a("KHd+"),l=Object(i.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{flat:""}},[a("v-row",{staticClass:"ml-0"},[a("v-col",{attrs:{md:"4",sm:"6"}},[a("v-menu",{ref:"display_picker",attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[a("v-text-field",t._g(t._b({attrs:{"prepend-icon":"mdi-calendar",readonly:"",disabled:t.fieldState||t.loading},model:{value:t.dateRangeText,callback:function(e){t.dateRangeText=e},expression:"dateRangeText"}},"v-text-field",o,!1),n))]}}]),model:{value:t.display_picker,callback:function(e){t.display_picker=e},expression:"display_picker"}},[t._v(" "),a("v-date-picker",{attrs:{range:"","no-title":""},on:{input:function(e){return t.sortDates()}},model:{value:t.filterDates,callback:function(e){t.filterDates=e},expression:"filterDates"}})],1)],1),t._v(" "),a("v-col",{staticClass:"text-right",attrs:{md:"8",sm:"6"}},[a("v-btn",{staticClass:"mt-2",attrs:{elevation:"5",color:"primary",loading:t.loading,disabled:t.fieldState},on:{click:function(e){return t.getData()}}},[a("v-icon",[t._v("mdi-sync")])],1),t._v(" "),a("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[t.disableExtraButton?t._e():a("v-btn",t._g(t._b({staticClass:"mt-1 ml-4 px-6 py-5 white--text",attrs:{elevation:"5",color:t.extraButtonColor}},"v-btn",o,!1),n),[t._t("extraButton",[a("v-icon",{attrs:{left:""}},[t._v("mdi-sync")]),t._v("\n              Button Label\n            ")])],2)]}}],null,!0),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[t._v(" "),a("v-card",[t._t("extraPromptContainer",[a("v-card-title",{staticClass:"text-h5"},[t._v("\n              Use Google's location service?\n            ")]),t._v(" "),a("v-card-text",[t._v("Let Google help apps determine location. This means sending anonymous location data to Google, even when no apps are running.")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{staticClass:"mt-1 ml-4 px-6 py-5",attrs:{color:"red darken-4",text:"",disabled:t.fieldState||t.loading},on:{click:function(e){t.dialog=!1}}},[t._v("\n              Batal\n            ")]),t._v(" "),a("v-btn",{staticClass:"mt-1 ml-4 px-6 py-5 white--text",attrs:{color:t.extraButtonColor,loading:t.fieldState||t.loading,disabled:t.fieldState||t.loading},on:{click:function(e){return t.postSelected()}}},[t._v("\n              Submit\n            ")])],1)],2)],1),t._v(" "),a("v-dialog",{attrs:{width:"500"},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on,o=e.attrs;return[t.disableDownloadButton?t._e():a("v-btn",t._g(t._b({staticClass:"mt-1 ml-4 px-6 py-5 white--text",attrs:{elevation:"5",color:t.downloadButtonColor}},"v-btn",o,!1),n),[t._t("downloadButton",[a("v-icon",{attrs:{left:""}},[t._v("mdi-sync")]),t._v("\n              Button Label\n            ")])],2)]}}],null,!0),model:{value:t.downloadDialog,callback:function(e){t.downloadDialog=e},expression:"downloadDialog"}},[t._v(" "),a("v-card",[t._t("downloadPromptContainer",[a("v-card-title",{staticClass:"text-h5"},[t._v("\n              Use Google's location service?\n            ")]),t._v(" "),a("v-card-text",[t._v("Let Google help apps determine location. This means sending anonymous location data to Google, even when no apps are running.")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{staticClass:"mt-1 ml-4 px-6 py-5",attrs:{color:"red darken-4",text:"",disabled:t.fieldState||t.loading},on:{click:function(e){t.downloadDialog=!1}}},[t._v("\n              Batal\n            ")]),t._v(" "),a("v-btn",{staticClass:"mt-1 ml-4 px-6 py-5 white--text",attrs:{color:t.downloadButtonColor,loading:t.fieldState||t.loading,disabled:t.fieldState||t.loading},on:{click:function(e){return t.downloadSelected()}}},[t._v("\n              Submit\n            ")])],1)],2)],1)],1),t._v(" "),a("v-col",{attrs:{md:"12",sm:"12"}},[a("v-switch",{attrs:{inset:"",label:"Sembunyikan Tanggal"},model:{value:t.hideTableDate,callback:function(e){t.hideTableDate=e},expression:"hideTableDate"}})],1)],1),t._v(" "),a("v-data-table",{attrs:{headers:t.tableHeaders,items:t.items,"hide-default-footer":"","fixed-header":"","disable-sort":"","no-data-text":"Tidak data untuk ditampilkan.",loading:t.loading,"loading-text":"Mohon menunggu ...","show-select":t.showSelect,"item-key":"uniqid"},scopedSlots:t._u([t._l(t.showDates,(function(e){return{key:t.headerSlotName(e),fn:function(e){var a=e.header;return[t._v("\n      "+t._s(t.reformatDateTime(a.text,"YYYY-MM-DD","DD MMMM"))+"\n    ")]}}})),t._l(t.showDates,(function(e){return{key:t.itemSlotName(e),fn:function(n){var o=n.item;return[a("v-tooltip",{attrs:{top:"",color:"transparent"},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,i=n.attrs;return[a("span",t._g(t._b({attrs:{color:o[e].ada_selisih>0?"red darken-4":"inherit"}},"span",i,!1),r),[t._v("\n            "+t._s(t.number_format(o[e].total_upah_harian))+"\n          ")])]}}],null,!0)},[t._v(" "),a("v-card",{attrs:{dark:"",flat:"",outlined:""}},[a("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[a("tbody",[a("tr",[a("th",{attrs:{scope:"row"}},[t._v("Tipe Kerja:")]),t._v(" "),a("td",{attrs:{align:"right"}})]),t._v(" "),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("Normal:")]),t._v(" "),a("td",{attrs:{align:"right"}},[t._v(t._s(t.showDuration(o[e].total_durasi_kerja,"kerja")))])]),t._v(" "),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("Standby:")]),t._v(" "),a("td",{attrs:{align:"right"}},[t._v(t._s(t.showDuration(o[e].total_durasi_standby,"standby")))])]),t._v(" "),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("Lembur 1:")]),t._v(" "),a("td",{attrs:{align:"right"}},[t._v(t._s(t.showDuration(o[e].total_durasi_split_lembur1,"lembur")))])]),t._v(" "),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("Lembur 2:")]),t._v(" "),a("td",{attrs:{align:"right"}},[t._v(t._s(t.showDuration(o[e].total_durasi_split_lembur2,"lembur")))])]),t._v(" "),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("Upah:")]),t._v(" "),a("td",{attrs:{align:"right"}},[a("p",{staticClass:"mb-0"},[t._v(t._s(o[e].ada_selisih>0?"Selisih Upah "+o[e].start_date:"Upah Harian"))])])]),t._v(" "),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("Upah Kerja:")]),t._v(" "),a("td",{attrs:{align:"right"}},[t._v(t._s(t.number_format(parseFloat(o[e].total_upah_harian)-parseFloat(o[e].total_upah_bbm))))])]),t._v(" "),a("tr",[a("th",{attrs:{scope:"row"}},[t._v("Upah BBM:")]),t._v(" "),a("td",{attrs:{align:"right"}},[t._v(t._s(t.number_format(o[e].total_upah_bbm)))])])])]},proxy:!0}],null,!0)})],1)],1)]}}})),{key:"item.total",fn:function(e){var n=e.item;return[a("span",{staticClass:"red--text text--darken-4 font-weight-medium"},[t._v(t._s(t.number_format(n.total)))])]}},t.items.length>0?{key:"body.append",fn:function(e){e.headers;return[a("tr",[a("td",{attrs:{colspan:t.showSelect?"7":"6",align:"right"}},[a("span",{staticClass:"font-weight-medium"},[t._v("\n            Total\n          ")])]),t._v(" "),t._l(t.showDates,(function(e){return t.hideTableDate?t._e():a("td",{attrs:{align:"right"}},[a("span",{staticClass:"red--text text--darken-4 font-weight-medium"},[t._v("\n            "+t._s(t.number_format(t.showTotal(e)))+"\n          ")])])})),t._v(" "),a("td",{attrs:{align:"right"}},[a("span",{staticClass:"red--text text--darken-4 font-weight-medium"},[t._v("\n            "+t._s(t.number_format(t.showGrandTotal()))+"\n          ")])])],2)]}}:null],null,!0),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),t._v(" "),a("v-snackbar",{attrs:{timeout:3e3,color:t.form_alert_color},model:{value:t.form_alert_state,callback:function(e){t.form_alert_state=e},expression:"form_alert_state"}},[t._v("\n    "+t._s(t.form_alert_text)+"\n  ")])],1)}),[],!1,null,null,null);e.default=l.exports}}]);